var Ce=(n,e,s)=>{if(!e.has(n))throw TypeError("Cannot "+s)};var f=(n,e,s)=>(Ce(n,e,"read from private field"),s?s.call(n):e.get(n)),S=(n,e,s)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,s)},k=(n,e,s,t)=>(Ce(n,e,"write to private field"),t?t.call(n,s):e.set(n,s),s);var A=(n,e,s)=>(Ce(n,e,"access private method"),s);import{s as N,e as b,d as T,S as x,v as C,k as U,n as y,i as _,p as X,T as ye,f as P,U as J,C as Ke,o as Q,r as Ne,V as Be,W as ie,x as be,X as qe,b as I,t as ae,j as Y,h as ce,l as v,m as Te,Y as Me}from"../chunks/scheduler.B668hpvB.js";import{S as B,i as G,t as w,g as ge,a as O,c as ve,f as xe,b as z,d as R,m as j,e as H,h as Pe}from"../chunks/index.BZ6YNAep.js";import{w as Ge}from"../chunks/index.C9t4z0HB.js";function ue(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Xe(n){let e,s="<p>Gioca a Color Clash in modalit√† portrait.</p>";return{c(){e=b("div"),e.innerHTML=s,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),x(e)!=="svelte-cy5swd"&&(e.innerHTML=s),this.h()},h(){C(e,"class","disclaimer svelte-12ah62n")},m(t,l){U(t,e,l)},p:y,i:y,o:y,d(t){t&&_(e)}}}class Je extends B{constructor(e){super(),G(this,e,null,Xe,N,{})}}const Ue="off",Qe="on",Ze="empty";var W,K,q,ee;class E{constructor(e,s,t){S(this,W,0);S(this,K,0);S(this,q,1);S(this,ee,Ue);k(this,q,t),k(this,W,e),k(this,K,s)}get row(){return f(this,W)}set row(e){k(this,W,e)}get col(){return f(this,K)}set col(e){k(this,K,e)}get type(){return f(this,q)}set type(e){k(this,q,e)}get status(){return f(this,ee)}set status(e){k(this,ee,e)}static get STATUS_OFF(){return Ue}static get STATUS_ON(){return Qe}static get STATUS_EMPTY(){return Ze}}W=new WeakMap,K=new WeakMap,q=new WeakMap,ee=new WeakMap;function et(n){let e,s,t,l;return{c(){e=b("div"),this.h()},l(i){e=T(i,"DIV",{class:!0,"aria-hidden":!0});var r=P(e);r.forEach(_),this.h()},h(){C(e,"class",s="cell cell-"+n[0].type+"-"+n[0].status+" svelte-g78r3r"),C(e,"aria-hidden","true")},m(i,r){U(i,e,r),t||(l=[J(e,"mouseenter",n[2]),J(e,"mouseleave",n[3]),J(e,"click",n[4])],t=!0)},p(i,r){r&1&&s!==(s="cell cell-"+i[0].type+"-"+i[0].status+" svelte-g78r3r")&&C(e,"class",s)},d(i){i&&_(e),t=!1,Ke(l)}}}function tt(n){let e,s,t,l;return{c(){e=b("div"),this.h()},l(i){e=T(i,"DIV",{class:!0,"aria-hidden":!0});var r=P(e);r.forEach(_),this.h()},h(){C(e,"class",s="cell cell-"+n[0].type+"-"+n[0].status+" svelte-g78r3r"),C(e,"aria-hidden","true")},m(i,r){U(i,e,r),t||(l=J(e,"touchstart",n[5],{passive:!0}),t=!0)},p(i,r){r&1&&s!==(s="cell cell-"+i[0].type+"-"+i[0].status+" svelte-g78r3r")&&C(e,"class",s)},d(i){i&&_(e),t=!1,l()}}}function st(n){let e;function s(i,r){return i[1]?tt:et}let t=s(n),l=t(n);return{c(){l.c(),e=X()},l(i){l.l(i),e=X()},m(i,r){l.m(i,r),U(i,e,r)},p(i,[r]){t===(t=s(i))&&l?l.p(i,r):(l.d(1),l=t(i),l&&(l.c(),l.m(e.parentNode,e)))},i:y,o:y,d(i){i&&_(e),l.d(i)}}}const lt=1500;function rt(n,e,s){let{cell:t}=e,{mobile:l}=e,i=!1,r=ye();const a=()=>{t.status!=E.STATUS_EMPTY&&r("getFocus",{r:t.row,c:t.col})},o=()=>{t.status!=E.STATUS_EMPTY&&r("lostFocus",{r:t.row,c:t.col})},u=()=>{t.status!=E.STATUS_EMPTY&&r("clash",{r:t.row,c:t.col})},d=()=>{i==!1?(i=!0,a(),setTimeout(()=>{o(),i=!1},lt)):u()};return n.$$set=g=>{"cell"in g&&s(0,t=g.cell),"mobile"in g&&s(1,l=g.mobile)},[t,l,a,o,u,d]}class nt extends B{constructor(e){super(),G(this,e,rt,st,N,{cell:0,mobile:1})}}class Se extends Array{add(e){e&&this.push(e)}has(e){return this.filter(s=>s==e).length>0}remove(){return this.shift()}}const ot=10,it=15,at=10,ct=8;var he,D,L,V,M,fe,de,Re,te,we,se,$e,le,Ee,re,Oe,pe,je,me,He,_e,We;class ze{constructor(e,s){S(this,de);S(this,te);S(this,se);S(this,le);S(this,re);S(this,pe);S(this,me);S(this,_e);S(this,he,3);S(this,D,[0][0]);S(this,L,0);S(this,V,0);S(this,M,new Se);S(this,fe,15);k(this,D,[...Array(e)].map((t,l)=>[...Array(s)].map((i,r)=>new E(l,r,A(this,de,Re).call(this))))),k(this,L,e),k(this,V,s)}get rows(){return f(this,L)}get cols(){return f(this,V)}getCell(e,s){return e>=0&&e<f(this,L)&&s>=0&&s<f(this,V)?f(this,D)[e][s]:null}preClashON(){f(this,M).map(e=>e.status=E.STATUS_ON)}preClashOFF(){f(this,M).map(e=>e.status=E.STATUS_OFF),f(this,M).length=0}preClash(e,s){f(this,M).length=0;let t=new Se,l=new Se,i=this.getCell(e,s),r=i.type;for(t.add(i);t.length>0;){let a=[],o=t.remove();l.has(o)||l.add(o),a.push(A(this,te,we).call(this,o)),a.push(A(this,se,$e).call(this,o)),a.push(A(this,le,Ee).call(this,o)),a.push(A(this,re,Oe).call(this,o)),a.forEach(u=>{u&&u.type==r&&u.status!=E.STATUS_EMPTY&&!l.has(u)&&t.add(u)})}l.length>1&&k(this,M,l)}clash(){let e=0;return f(this,M).length>0&&(e=Math.pow(f(this,M).length-2,2)),f(this,M).map(s=>{s.status=E.STATUS_EMPTY}),f(this,M).length=0,e}findTop(e){let s=e.row-1;for(;s>=0;){let t=this.getCell(s--,e.col);if(t.status!=E.STATUS_EMPTY)return t}return null}findRight(e){let s=e.col+1;for(;s<=f(this,V)-1;){let t=this.getCell(e.row,s--);if(t.status!=E.STATUS_EMPTY)return t}return null}swapCells(e,s){let[t,l]=[e.row,e.col];f(this,D)[s.row][s.col]=e,f(this,D)[e.row][e.col]=s,e.row=s.row,e.col=s.col,s.row=t,s.col=l}shiftCells(){A(this,pe,je).call(this),A(this,me,He).call(this)}isGameOver(){let e=0,s=f(this,D).flat(1).filter(t=>t.status!=E.STATUS_EMPTY);return s.length<=f(this,fe)?(s.forEach(t=>{e+=A(this,_e,We).call(this,t)}),e==0):!1}}he=new WeakMap,D=new WeakMap,L=new WeakMap,V=new WeakMap,M=new WeakMap,fe=new WeakMap,de=new WeakSet,Re=function(){return Math.floor(Math.random()*f(this,he))+1},te=new WeakSet,we=function(e){return this.getCell(e.row-1,e.col)},se=new WeakSet,$e=function(e){return this.getCell(e.row+1,e.col)},le=new WeakSet,Ee=function(e){return this.getCell(e.row,e.col+1)},re=new WeakSet,Oe=function(e){return this.getCell(e.row,e.col-1)},pe=new WeakSet,je=function(){for(let e=f(this,L)-1;e>0;e--)f(this,D)[e].filter(t=>t.status==E.STATUS_EMPTY).forEach(t=>{let l=this.findTop(t);l&&l.status!=E.STATUS_EMPTY&&this.swapCells(t,l)})},me=new WeakSet,He=function(){f(this,D)[f(this,L)-1].filter(s=>s.status==E.STATUS_EMPTY).forEach(s=>{for(let t=s.col;t<f(this,V)-1;t++)for(let l=f(this,L)-1;l>=0;l--){let i=this.getCell(l,t),r=this.getCell(l,t+1);this.swapCells(i,r)}})},_e=new WeakSet,We=function(e){return[A(this,te,we).call(this,e),A(this,se,$e).call(this,e),A(this,le,Ee).call(this,e),A(this,re,Oe).call(this,e)].filter(t=>t&&t.type==e.type&&t.status!=E.STATUS_EMPTY).length};class ut extends ze{constructor(){super(ot,it)}}class ht extends ze{constructor(){super(at,ct)}}const Z=Ge(0),oe=Ge(0);function Fe(n,e,s){const t=n.slice();return t[10]=e[s],t[12]=s,t}function De(n,e,s){const t=n.slice();return t[10]=e[s],t[14]=s,t}function Le(n){let e,s,t=ue({length:n[0].rows}),l=[];for(let r=0;r<t.length;r+=1)l[r]=Ie(Fe(n,t,r));const i=r=>O(l[r],1,1,()=>{l[r]=null});return{c(){e=b("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=T(r,"DIV",{class:!0});var a=P(e);for(let o=0;o<l.length;o+=1)l[o].l(a);a.forEach(_),this.h()},h(){C(e,"class","board visible svelte-ju0al5")},m(r,a){U(r,e,a);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null);s=!0},p(r,a){if(a&31){t=ue({length:r[0].rows});let o;for(o=0;o<t.length;o+=1){const u=Fe(r,t,o);l[o]?(l[o].p(u,a),w(l[o],1)):(l[o]=Ie(u),l[o].c(),w(l[o],1),l[o].m(e,null))}for(ge(),o=t.length;o<l.length;o+=1)i(o);ve()}},i(r){if(!s){for(let a=0;a<t.length;a+=1)w(l[a]);s=!0}},o(r){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)O(l[a]);s=!1},d(r){r&&_(e),Be(l,r)}}}function Ve(n){let e,s,t;function l(r){n[5](r)}let i={cell:n[0].getCell(n[12],n[14])};return n[1]!==void 0&&(i.mobile=n[1]),e=new nt({props:i}),be.push(()=>xe(e,"mobile",l)),e.$on("getFocus",n[2]),e.$on("lostFocus",n[3]),e.$on("clash",n[4]),{c(){z(e.$$.fragment)},l(r){R(e.$$.fragment,r)},m(r,a){j(e,r,a),t=!0},p(r,a){const o={};a&1&&(o.cell=r[0].getCell(r[12],r[14])),!s&&a&2&&(s=!0,o.mobile=r[1],qe(()=>s=!1)),e.$set(o)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){O(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function Ie(n){let e,s,t=ue({length:n[0].cols}),l=[];for(let r=0;r<t.length;r+=1)l[r]=Ve(De(n,t,r));const i=r=>O(l[r],1,1,()=>{l[r]=null});return{c(){for(let r=0;r<l.length;r+=1)l[r].c();e=X()},l(r){for(let a=0;a<l.length;a+=1)l[a].l(r);e=X()},m(r,a){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(r,a);U(r,e,a),s=!0},p(r,a){if(a&31){t=ue({length:r[0].cols});let o;for(o=0;o<t.length;o+=1){const u=De(r,t,o);l[o]?(l[o].p(u,a),w(l[o],1)):(l[o]=Ve(u),l[o].c(),w(l[o],1),l[o].m(e.parentNode,e))}for(ge(),o=t.length;o<l.length;o+=1)i(o);ve()}},i(r){if(!s){for(let a=0;a<t.length;a+=1)w(l[a]);s=!0}},o(r){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)O(l[a]);s=!1},d(r){r&&_(e),Be(l,r)}}}function ft(n){let e,s,t=n[0]&&Le(n);return{c(){t&&t.c(),e=X()},l(l){t&&t.l(l),e=X()},m(l,i){t&&t.m(l,i),U(l,e,i),s=!0},p(l,[i]){l[0]?t?(t.p(l,i),i&1&&w(t,1)):(t=Le(l),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(ge(),O(t,1,1,()=>{t=null}),ve())},i(l){s||(w(t),s=!0)},o(l){O(t),s=!1},d(l){l&&_(e),t&&t.d(l)}}}function dt(n,e,s){let t;Q(n,oe,h=>s(6,t=h));let l=ye(),i=[0][0],r=!1;const a=h=>h.includes("Android")||h.includes("Mobile")||h.includes("iPhone");Ne(()=>{s(1,r=a(navigator.userAgent)),s(0,i=r?new ht:new ut)});const o=()=>{s(0,i)},u=h=>{i.preClash(h.detail.r,h.detail.c),i.preClashON(),o()},d=h=>{i.preClashOFF(),o()},g=h=>{let m=i.clash();i.shiftCells(),o(),m>0&&(ie(oe,t=0,t),ie(oe,t=m,t)),i.isGameOver()&&l("gameOver")};function $(h){r=h,s(1,r)}return[i,r,u,d,g,$]}class pt extends B{constructor(e){super(),G(this,e,dt,ft,N,{})}}function mt(n){let e,s,t="Complimenti hai totalizzato",l,i,r,a,o,u,d="Nuova Partita",g,$;return{c(){e=b("div"),s=b("p"),s.textContent=t,l=I(),i=b("p"),r=ae(n[0]),a=ae(" punti"),o=I(),u=b("button"),u.textContent=d,this.h()},l(h){e=T(h,"DIV",{class:!0});var m=P(e);s=T(m,"P",{class:!0,"data-svelte-h":!0}),x(s)!=="svelte-13a9859"&&(s.textContent=t),l=Y(m),i=T(m,"P",{class:!0});var c=P(i);r=ce(c,n[0]),a=ce(c," punti"),c.forEach(_),o=Y(m),u=T(m,"BUTTON",{class:!0,"data-svelte-h":!0}),x(u)!=="svelte-16cozwr"&&(u.textContent=d),m.forEach(_),this.h()},h(){C(s,"class","score-size svelte-1eh566z"),C(i,"class","score-size svelte-1eh566z"),C(u,"class","svelte-1eh566z"),C(e,"class","score string visible svelte-1eh566z")},m(h,m){U(h,e,m),v(e,s),v(e,l),v(e,i),v(i,r),v(i,a),v(e,o),v(e,u),g||($=J(u,"click",n[2]),g=!0)},p(h,[m]){m&1&&Te(r,h[0])},i:y,o:y,d(h){h&&_(e),g=!1,$()}}}function _t(n,e,s){let t;Q(n,Z,r=>s(0,t=r));let l=ye();return[t,l,()=>l("newGame")]}class gt extends B{constructor(e){super(),G(this,e,_t,mt,N,{})}}function vt(n){let e,s='<p class="string rot-left svelte-f9ujjw">COLOR</p> <p class="string rot-right svelte-f9ujjw">CLASH</p>';return{c(){e=b("div"),e.innerHTML=s,this.h()},l(t){e=T(t,"DIV",{class:!0,"data-svelte-h":!0}),x(e)!=="svelte-rzmafg"&&(e.innerHTML=s),this.h()},h(){C(e,"class","col-left-top visible svelte-f9ujjw")},m(t,l){U(t,e,l)},p:y,i:y,o:y,d(t){t&&_(e)}}}class Ct extends B{constructor(e){super(),G(this,e,null,vt,N,{})}}function St(n){const e=n-1;return e*e*e+1}function Ye(n,{delay:e=0,duration:s=400,easing:t=St,x:l=0,y:i=0,opacity:r=0}={}){const a=getComputedStyle(n),o=+a.opacity,u=a.transform==="none"?"":a.transform,d=o*(1-r),[g,$]=Me(l),[h,m]=Me(i);return{delay:e,duration:s,easing:t,css:(c,p)=>`
			transform: ${u} translate(${(1-c)*g}${$}, ${(1-c)*h}${m});
			opacity: ${o-d*p}`}}function bt(n){let e,s,t,l="BEST SCORE",i,r,a,o,u,d,g="TOTAL SCORE",$,h,m;return{c(){e=b("div"),s=b("div"),t=b("p"),t.textContent=l,i=I(),r=b("p"),a=ae(n[0]),o=I(),u=b("div"),d=b("p"),d.textContent=g,$=I(),h=b("p"),m=ae(n[3]),this.h()},l(c){e=T(c,"DIV",{class:!0});var p=P(e);s=T(p,"DIV",{});var F=P(s);t=T(F,"P",{class:!0,"data-svelte-h":!0}),x(t)!=="svelte-kkvpfh"&&(t.textContent=l),i=Y(F),r=T(F,"P",{class:!0});var Ae=P(r);a=ce(Ae,n[0]),Ae.forEach(_),F.forEach(_),o=Y(p),u=T(p,"DIV",{});var ne=P(u);d=T(ne,"P",{class:!0,"data-svelte-h":!0}),x(d)!=="svelte-hfxbvx"&&(d.textContent=g),$=Y(ne),h=T(ne,"P",{class:!0});var ke=P(h);m=ce(ke,n[3]),ke.forEach(_),ne.forEach(_),p.forEach(_),this.h()},h(){C(t,"class","string score-title svelte-c5md7a"),C(r,"class","string score-score svelte-c5md7a"),C(d,"class","string score-title svelte-c5md7a"),C(h,"class","string score-score svelte-c5md7a"),C(e,"class","col-right-top visible svelte-c5md7a")},m(c,p){U(c,e,p),v(e,s),v(s,t),v(s,i),v(s,r),v(r,a),n[5](r),v(e,o),v(e,u),v(u,d),v(u,$),v(u,h),v(h,m),n[6](h)},p(c,[p]){p&1&&Te(a,c[0]),p&8&&Te(m,c[3])},i:y,o:y,d(c){c&&_(e),n[5](null),n[6](null)}}}function Tt(n,e,s){let t,l;Q(n,Z,c=>s(3,t=c)),Q(n,oe,c=>s(4,l=c));let i=0,r,a,o,u;Ne(()=>{s(0,i=d())});const d=()=>{let c=localStorage.getItem("bestScore");return c?+c:0},g=c=>{localStorage.setItem("bestScore",c),s(0,i=c)},$=()=>{ie(Z,t+=l,t),t>i&&(g(t),u=Pe(o,Ye,{x:-200}),u.start()),a=Pe(r,Ye,{x:-200}),a.start()};function h(c){be[c?"unshift":"push"](()=>{o=c,s(2,o)})}function m(c){be[c?"unshift":"push"](()=>{r=c,s(1,r)})}return n.$$.update=()=>{n.$$.dirty&16&&l>0&&$()},[i,r,o,t,l,h,m]}class wt extends B{constructor(e){super(),G(this,e,Tt,bt,N,{})}}function $t(n){let e,s;return e=new gt({}),e.$on("newGame",n[3]),{c(){z(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){j(e,t,l),s=!0},p:y,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){O(e.$$.fragment,t),s=!1},d(t){H(e,t)}}}function Et(n){let e,s;return e=new pt({}),e.$on("gameOver",n[2]),{c(){z(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,l){j(e,t,l),s=!0},p:y,i(t){s||(w(e.$$.fragment,t),s=!0)},o(t){O(e.$$.fragment,t),s=!1},d(t){H(e,t)}}}function Ot(n){let e,s,t,l,i,r,a,o,u,d,g;e=new Je({}),l=new Ct({});const $=[Et,$t],h=[];function m(c,p){return c[0]==!1?0:1}return a=m(n),o=h[a]=$[a](n),d=new wt({}),{c(){z(e.$$.fragment),s=I(),t=b("div"),z(l.$$.fragment),i=I(),r=b("div"),o.c(),u=I(),z(d.$$.fragment),this.h()},l(c){R(e.$$.fragment,c),s=Y(c),t=T(c,"DIV",{class:!0});var p=P(t);R(l.$$.fragment,p),i=Y(p),r=T(p,"DIV",{class:!0});var F=P(r);o.l(F),F.forEach(_),u=Y(p),R(d.$$.fragment,p),p.forEach(_),this.h()},h(){C(r,"class","col-center-top visible svelte-16fldc6"),C(t,"class","wrapper svelte-16fldc6")},m(c,p){j(e,c,p),U(c,s,p),U(c,t,p),j(l,t,null),v(t,i),v(t,r),h[a].m(r,null),v(t,u),j(d,t,null),g=!0},p(c,[p]){let F=a;a=m(c),a===F?h[a].p(c,p):(ge(),O(h[F],1,1,()=>{h[F]=null}),ve(),o=h[a],o?o.p(c,p):(o=h[a]=$[a](c),o.c()),w(o,1),o.m(r,null))},i(c){g||(w(e.$$.fragment,c),w(l.$$.fragment,c),w(o),w(d.$$.fragment,c),g=!0)},o(c){O(e.$$.fragment,c),O(l.$$.fragment,c),O(o),O(d.$$.fragment,c),g=!1},d(c){c&&(_(s),_(t)),H(e,c),H(l),h[a].d(),H(d)}}}function yt(n,e,s){let t;Q(n,Z,a=>s(1,t=a));let l=!1;return[l,t,()=>s(0,l=!0),()=>{s(0,l=!1),ie(Z,t=0,t)}]}class Ut extends B{constructor(e){super(),G(this,e,yt,Ot,N,{})}}export{Ut as component};
